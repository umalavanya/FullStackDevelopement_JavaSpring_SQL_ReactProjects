<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise 82: Calendar Widget</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px 20px;
        }

        .container {
            width: 100%;
            max-width: 1400px;
            background: white;
            border-radius: 30px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            animation: slideUp 0.6s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 40px;
            text-align: center;
        }

        h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            min-height: 600px;
        }

        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .calendar-panel {
            padding: 40px;
            background: #f8f9fa;
        }

        .sidebar {
            padding: 40px;
            background: white;
            border-left: 1px solid #e0e0e0;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .current-month {
            font-size: 2em;
            font-weight: 700;
            color: #333;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .month-year {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .month-name {
            font-size: 1.2em;
        }

        .year {
            font-size: 0.8em;
            opacity: 0.7;
            font-weight: normal;
        }

        .navigation-buttons {
            display: flex;
            gap: 15px;
        }

        .nav-btn {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            background: white;
            color: #666;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .nav-btn:hover {
            border-color: #667eea;
            color: #667eea;
            transform: translateY(-2px);
        }

        .today-btn {
            padding: 12px 25px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            color: #666;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .today-btn:hover {
            border-color: #667eea;
            color: #667eea;
            transform: translateY(-2px);
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .weekday-header {
            text-align: center;
            padding: 15px 10px;
            font-weight: 600;
            color: #667eea;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            font-size: 1.1em;
        }

        .calendar-day {
            aspect-ratio: 1;
            background: white;
            border-radius: 15px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border: 2px solid transparent;
        }

        .calendar-day:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            border-color: #667eea;
        }

        .calendar-day.other-month {
            opacity: 0.4;
            background: #f8f9fa;
        }

        .calendar-day.today {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .calendar-day.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .calendar-day.has-events::after {
            content: '';
            position: absolute;
            top: 10px;
            right: 10px;
            width: 8px;
            height: 8px;
            background: #4CAF50;
            border-radius: 50%;
        }

        .day-number {
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .day-events {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 5px;
            overflow: hidden;
        }

        .event-dot {
            width: 100%;
            height: 4px;
            border-radius: 2px;
            margin-bottom: 2px;
        }

        .event-dot.work {
            background: #667eea;
        }

        .event-dot.personal {
            background: #4CAF50;
        }

        .event-dot.social {
            background: #FF9800;
        }

        .event-dot.important {
            background: #f44336;
        }

        .calendar-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .legend-label {
            color: #666;
            font-size: 0.9em;
        }

        .sidebar-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .sidebar-title {
            font-size: 1.5em;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .selected-date {
            color: #666;
            font-size: 1.1em;
        }

        .events-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 30px;
        }

        .event-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .event-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .event-item.work {
            border-left-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }

        .event-item.personal {
            border-left-color: #4CAF50;
            background: rgba(76, 175, 80, 0.05);
        }

        .event-item.social {
            border-left-color: #FF9800;
            background: rgba(255, 152, 0, 0.05);
        }

        .event-item.important {
            border-left-color: #f44336;
            background: rgba(244, 67, 54, 0.05);
        }

        .event-time {
            color: #667eea;
            font-weight: 600;
            font-size: 0.9em;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .event-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .event-description {
            color: #666;
            font-size: 0.9em;
            line-height: 1.5;
        }

        .empty-events {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .empty-icon {
            font-size: 3em;
            color: #e0e0e0;
            margin-bottom: 15px;
        }

        .add-event-form {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
        }

        .form-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            color: #666;
            font-size: 0.9em;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            background: white;
            cursor: pointer;
        }

        .form-select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-buttons {
            display: flex;
            gap: 15px;
        }

        .form-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .clear-btn {
            background: #f8f9fa;
            color: #666;
            border: 2px solid #e0e0e0;
        }

        .clear-btn:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .calendar-views {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
        }

        .view-btn {
            padding: 12px 25px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            color: #666;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .view-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .view-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .mini-calendar {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-top: 30px;
        }

        .mini-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .mini-month {
            font-weight: 600;
            color: #333;
        }

        .mini-nav-btn {
            width: 30px;
            height: 30px;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            background: white;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
        }

        .mini-nav-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .mini-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .mini-day {
            text-align: center;
            padding: 8px 5px;
            font-size: 0.9em;
            border-radius: 8px;
            cursor: pointer;
        }

        .mini-day.other-month {
            opacity: 0.4;
        }

        .mini-day.today {
            background: #667eea;
            color: white;
        }

        .mini-day.selected {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
            font-weight: 600;
        }

        .monthly-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 30px;
        }

        .stat-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
        }

        .theme-toggle {
            position: fixed;
            top: 30px;
            right: 30px;
            background: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            font-size: 1.2em;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .theme-toggle:hover {
            transform: rotate(30deg);
        }

        .dark-mode {
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
        }

        .dark-mode .container {
            background: #1a1a2e;
            color: white;
        }

        .dark-mode header {
            background: linear-gradient(135deg, #0f0c29, #302b63);
        }

        .dark-mode .calendar-panel {
            background: #16213e;
        }

        .dark-mode .sidebar {
            background: #1a1a2e;
            border-left-color: #302b63;
        }

        .dark-mode .current-month {
            color: white;
        }

        .dark-mode .calendar-day {
            background: #16213e;
            color: white;
        }

        .dark-mode .calendar-day.other-month {
            background: #0f0c29;
            opacity: 0.6;
        }

        .dark-mode .weekday-header {
            background: rgba(102, 126, 234, 0.2);
        }

        .dark-mode .event-item {
            background: #16213e;
        }

        .dark-mode .event-title {
            color: white;
        }

        .dark-mode .event-description {
            color: #b0b0b0;
        }

        .dark-mode .add-event-form {
            background: #16213e;
        }

        .dark-mode .form-title {
            color: white;
        }

        .dark-mode .form-input,
        .dark-mode .form-select {
            background: #0f0c29;
            border-color: #302b63;
            color: white;
        }

        .dark-mode .stat-card {
            background: #16213e;
        }

        .dark-mode .stat-label {
            color: #b0b0b0;
        }

        .dark-mode .mini-calendar {
            background: #16213e;
        }

        .dark-mode .mini-month {
            color: white;
        }

        @media (max-width: 768px) {
            .calendar-grid {
                gap: 10px;
            }

            .calendar-day {
                padding: 10px;
            }

            .day-number {
                font-size: 1.2em;
            }

            .monthly-stats {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <button class="theme-toggle" onclick="toggleTheme()">üåì</button>

    <div class="container">
        <header>
            <h1><i class="fas fa-calendar-alt"></i> Calendar Widget</h1>
            <p class="subtitle">Interactive calendar with event management, monthly navigation, and detailed views</p>
        </header>

        <div class="main-content">
            <div class="calendar-panel">
                <div class="calendar-header">
                    <div class="current-month">
                        <div class="month-year">
                            <div class="month-name" id="currentMonth">January</div>
                            <div class="year" id="currentYear">2024</div>
                        </div>
                    </div>

                    <div class="navigation-buttons">
                        <button class="nav-btn" onclick="previousYear()">
                            <i class="fas fa-angle-double-left"></i>
                        </button>
                        <button class="nav-btn" onclick="previousMonth()">
                            <i class="fas fa-angle-left"></i>
                        </button>
                        <button class="today-btn" onclick="goToToday()">
                            <i class="fas fa-calendar-day"></i> Today
                        </button>
                        <button class="nav-btn" onclick="nextMonth()">
                            <i class="fas fa-angle-right"></i>
                        </button>
                        <button class="nav-btn" onclick="nextYear()">
                            <i class="fas fa-angle-double-right"></i>
                        </button>
                    </div>
                </div>

                <div class="calendar-views">
                    <button class="view-btn active" onclick="setView('month')">
                        <i class="fas fa-calendar-alt"></i> Month
                    </button>
                    <button class="view-btn" onclick="setView('week')">
                        <i class="fas fa-calendar-week"></i> Week
                    </button>
                    <button class="view-btn" onclick="setView('year')">
                        <i class="fas fa-calendar"></i> Year
                    </button>
                </div>

                <div class="calendar-grid" id="calendarGrid">
                    <!-- Weekday headers -->
                    <div class="weekday-header">Sun</div>
                    <div class="weekday-header">Mon</div>
                    <div class="weekday-header">Tue</div>
                    <div class="weekday-header">Wed</div>
                    <div class="weekday-header">Thu</div>
                    <div class="weekday-header">Fri</div>
                    <div class="weekday-header">Sat</div>

                    <!-- Calendar days will be populated by JavaScript -->
                </div>

                <div class="calendar-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #667eea;"></div>
                        <div class="legend-label">Work</div>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #4CAF50;"></div>
                        <div class="legend-label">Personal</div>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #FF9800;"></div>
                        <div class="legend-label">Social</div>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #f44336;"></div>
                        <div class="legend-label">Important</div>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color"
                            style="background: #667eea; border-radius: 50%; width: 16px; height: 16px;"></div>
                        <div class="legend-label">Today</div>
                    </div>
                </div>
            </div>

            <div class="sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">
                        <i class="fas fa-calendar-day"></i> Selected Date
                    </div>
                    <div class="selected-date" id="selectedDate">Sunday, January 1, 2024</div>
                </div>

                <div class="events-list" id="eventsList">
                    <!-- Events will be populated by JavaScript -->
                </div>

                <div class="add-event-form">
                    <div class="form-title">
                        <i class="fas fa-plus-circle"></i> Add New Event
                    </div>

                    <div class="form-group">
                        <label class="form-label">Event Title</label>
                        <input type="text" class="form-input" id="eventTitle" placeholder="Meeting, Birthday, etc.">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Event Time</label>
                        <input type="time" class="form-input" id="eventTime" value="12:00">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Category</label>
                        <select class="form-select" id="eventCategory">
                            <option value="work">Work</option>
                            <option value="personal">Personal</option>
                            <option value="social">Social</option>
                            <option value="important">Important</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Description (Optional)</label>
                        <textarea class="form-input" id="eventDescription" rows="3"
                            placeholder="Add event details..."></textarea>
                    </div>

                    <div class="form-buttons">
                        <button class="form-btn submit-btn" onclick="addEvent()">
                            <i class="fas fa-check"></i> Add Event
                        </button>
                        <button class="form-btn clear-btn" onclick="clearForm()">
                            <i class="fas fa-times"></i> Clear
                        </button>
                    </div>
                </div>

                <div class="mini-calendar">
                    <div class="mini-header">
                        <div class="mini-month" id="miniMonth">Jan 2024</div>
                        <div>
                            <button class="mini-nav-btn" onclick="previousMiniMonth()">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="mini-nav-btn" onclick="nextMiniMonth()">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    <div class="mini-grid" id="miniCalendar">
                        <!-- Mini calendar will be populated by JavaScript -->
                    </div>
                </div>

                <div class="monthly-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="totalEvents">0</div>
                        <div class="stat-label">Total Events</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="workEvents">0</div>
                        <div class="stat-label">Work Events</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="personalEvents">0</div>
                        <div class="stat-label">Personal Events</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="upcomingEvents">0</div>
                        <div class="stat-label">Upcoming This Week</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Calendar state
        let currentDate = new Date();
        let selectedDate = new Date();
        let events = JSON.parse(localStorage.getItem('calendarEvents')) || [];
        let currentView = 'month';
        let miniCalendarDate = new Date();

        // Event categories
        const eventCategories = {
            work: { name: 'Work', color: '#667eea', icon: 'fas fa-briefcase' },
            personal: { name: 'Personal', color: '#4CAF50', icon: 'fas fa-user' },
            social: { name: 'Social', color: '#FF9800', icon: 'fas fa-users' },
            important: { name: 'Important', color: '#f44336', icon: 'fas fa-star' }
        };

        // Sample events
        const sampleEvents = [
            {
                id: 1,
                title: "Team Meeting",
                date: new Date(currentDate.getFullYear(), currentDate.getMonth(), 15),
                time: "10:00",
                category: "work",
                description: "Weekly team sync meeting"
            },
            {
                id: 2,
                title: "Doctor Appointment",
                date: new Date(currentDate.getFullYear(), currentDate.getMonth(), 18),
                time: "14:30",
                category: "personal",
                description: "Annual checkup"
            },
            {
                id: 3,
                title: "Birthday Party",
                date: new Date(currentDate.getFullYear(), currentDate.getMonth(), 20),
                time: "19:00",
                category: "social",
                description: "Friend's birthday celebration"
            },
            {
                id: 4,
                title: "Project Deadline",
                date: new Date(currentDate.getFullYear(), currentDate.getMonth(), 25),
                time: "23:59",
                category: "important",
                description: "Submit final project deliverables"
            },
            {
                id: 5,
                title: "Gym Session",
                date: new Date(),
                time: "18:00",
                category: "personal",
                description: "Weekly workout routine"
            }
        ];

        // Initialize with sample events if empty
        if (events.length === 0) {
            events = sampleEvents;
            localStorage.setItem('calendarEvents', JSON.stringify(events));
        }

        // DOM Elements
        const currentMonthElement = document.getElementById('currentMonth');
        const currentYearElement = document.getElementById('currentYear');
        const calendarGrid = document.getElementById('calendarGrid');
        const selectedDateElement = document.getElementById('selectedDate');
        const eventsList = document.getElementById('eventsList');
        const eventTitle = document.getElementById('eventTitle');
        const eventTime = document.getElementById('eventTime');
        const eventCategory = document.getElementById('eventCategory');
        const eventDescription = document.getElementById('eventDescription');
        const totalEventsElement = document.getElementById('totalEvents');
        const workEventsElement = document.getElementById('workEvents');
        const personalEventsElement = document.getElementById('personalEvents');
        const upcomingEventsElement = document.getElementById('upcomingEvents');
        const miniCalendar = document.getElementById('miniCalendar');
        const miniMonthElement = document.getElementById('miniMonth');

        // Initialize
        function init() {
            renderCalendar();
            updateSelectedDateDisplay();
            renderEventsForSelectedDate();
            updateStatistics();
            renderMiniCalendar();

            // Format dates in events from localStorage
            events = events.map(event => ({
                ...event,
                date: new Date(event.date)
            }));
        }

        // Render calendar
        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            // Update header
            currentMonthElement.textContent = getMonthName(month);
            currentYearElement.textContent = year;

            // Clear existing days (keep weekday headers)
            while (calendarGrid.children.length > 7) {
                calendarGrid.removeChild(calendarGrid.lastChild);
            }

            // Get first day of month and total days
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const totalDays = lastDay.getDate();
            const startingDay = firstDay.getDay(); // 0 = Sunday, 1 = Monday, etc.

            // Add days from previous month
            const prevMonthLastDay = new Date(year, month, 0).getDate();
            for (let i = startingDay - 1; i >= 0; i--) {
                const day = prevMonthLastDay - i;
                const date = new Date(year, month - 1, day);
                addCalendarDay(date, true);
            }

            // Add days from current month
            const today = new Date();
            for (let day = 1; day <= totalDays; day++) {
                const date = new Date(year, month, day);
                const isToday = date.toDateString() === today.toDateString();
                addCalendarDay(date, false, isToday);
            }

            // Add days from next month
            const daysAdded = startingDay + totalDays;
            const daysNeeded = 42 - daysAdded; // 6 rows of 7 days
            for (let day = 1; day <= daysNeeded; day++) {
                const date = new Date(year, month + 1, day);
                addCalendarDay(date, true);
            }
        }

        // Add calendar day element
        function addCalendarDay(date, isOtherMonth, isToday = false) {
            const day = document.createElement('div');
            day.className = 'calendar-day';

            if (isOtherMonth) {
                day.classList.add('other-month');
            }

            if (isToday) {
                day.classList.add('today');
            }

            // Check if this day is selected
            if (date.toDateString() === selectedDate.toDateString()) {
                day.classList.add('selected');
            }

            // Check if this day has events
            const dayEvents = getEventsForDate(date);
            if (dayEvents.length > 0) {
                day.classList.add('has-events');
            }

            day.innerHTML = `
                <div class="day-number">${date.getDate()}</div>
                <div class="day-events">
                    ${dayEvents.slice(0, 3).map(event => `
                        <div class="event-dot ${event.category}" style="background: ${eventCategories[event.category].color}"></div>
                    `).join('')}
                </div>
            `;

            day.onclick = () => selectDate(date);
            calendarGrid.appendChild(day);
        }

        // Select date
        function selectDate(date) {
            selectedDate = date;

            // Update UI
            renderCalendar();
            updateSelectedDateDisplay();
            renderEventsForSelectedDate();
            updateStatistics();

            // Update mini calendar selection
            renderMiniCalendar();
        }

        // Update selected date display
        function updateSelectedDateDisplay() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            selectedDateElement.textContent = selectedDate.toLocaleDateString('en-US', options);
        }

        // Get events for specific date
        function getEventsForDate(date) {
            return events.filter(event =>
                event.date.getDate() === date.getDate() &&
                event.date.getMonth() === date.getMonth() &&
                event.date.getFullYear() === date.getFullYear()
            );
        }

        // Render events for selected date
        function renderEventsForSelectedDate() {
            const dayEvents = getEventsForDate(selectedDate);

            if (dayEvents.length === 0) {
                eventsList.innerHTML = `
                    <div class="empty-events">
                        <div class="empty-icon">
                            <i class="fas fa-calendar-plus"></i>
                        </div>
                        <div>No events for this day</div>
                        <div style="margin-top: 10px; font-size: 0.9em; opacity: 0.7;">
                            Add an event using the form below
                        </div>
                    </div>
                `;
                return;
            }

            // Sort events by time
            dayEvents.sort((a, b) => a.time.localeCompare(b.time));

            eventsList.innerHTML = '';
            dayEvents.forEach(event => {
                const eventItem = document.createElement('div');
                eventItem.className = `event-item ${event.category}`;

                const category = eventCategories[event.category];

                eventItem.innerHTML = `
                    <div class="event-time">
                        <i class="${category.icon}"></i>
                        ${formatTime(event.time)}
                    </div>
                    <div class="event-title">${event.title}</div>
                    <div class="event-description">${event.description}</div>
                `;

                eventsList.appendChild(eventItem);
            });
        }

        // Add new event
        function addEvent() {
            const title = eventTitle.value.trim();
            const time = eventTime.value;
            const category = eventCategory.value;
            const description = eventDescription.value.trim();

            if (!title) {
                alert('Please enter an event title');
                return;
            }

            const newEvent = {
                id: Date.now(),
                title: title,
                date: new Date(selectedDate),
                time: time,
                category: category,
                description: description || 'No description'
            };

            events.push(newEvent);
            localStorage.setItem('calendarEvents', JSON.stringify(events));

            // Update UI
            renderCalendar();
            renderEventsForSelectedDate();
            updateStatistics();
            clearForm();

            // Show success message
            showNotification(`Event "${title}" added successfully!`);
        }

        // Clear form
        function clearForm() {
            eventTitle.value = '';
            eventTime.value = '12:00';
            eventCategory.value = 'work';
            eventDescription.value = '';
        }

        // Update statistics
        function updateStatistics() {
            const currentMonthEvents = events.filter(event =>
                event.date.getMonth() === currentDate.getMonth() &&
                event.date.getFullYear() === currentDate.getFullYear()
            );

            // Count events by category
            const workEventsCount = currentMonthEvents.filter(e => e.category === 'work').length;
            const personalEventsCount = currentMonthEvents.filter(e => e.category === 'personal').length;

            // Count upcoming events this week
            const today = new Date();
            const nextWeek = new Date(today);
            nextWeek.setDate(today.getDate() + 7);

            const upcomingEventsCount = events.filter(event =>
                event.date >= today && event.date <= nextWeek
            ).length;

            // Update display
            totalEventsElement.textContent = currentMonthEvents.length;
            workEventsElement.textContent = workEventsCount;
            personalEventsElement.textContent = personalEventsCount;
            upcomingEventsElement.textContent = upcomingEventsCount;
        }

        // Navigation functions
        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
            updateStatistics();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
            updateStatistics();
        }

        function previousYear() {
            currentDate.setFullYear(currentDate.getFullYear() - 1);
            renderCalendar();
            updateStatistics();
        }

        function nextYear() {
            currentDate.setFullYear(currentDate.getFullYear() + 1);
            renderCalendar();
            updateStatistics();
        }

        function goToToday() {
            currentDate = new Date();
            selectedDate = new Date();
            renderCalendar();
            updateSelectedDateDisplay();
            renderEventsForSelectedDate();
            updateStatistics();
            renderMiniCalendar();

            // Scroll to today
            const todayElements = document.querySelectorAll('.today');
            if (todayElements.length > 0) {
                todayElements[0].scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // Set view mode
        function setView(view) {
            currentView = view;

            // Update view buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // In a real application, this would switch between different calendar views
            // For this demo, we'll just show an alert
            showNotification(`Switched to ${view} view`);
        }

        // Render mini calendar
        function renderMiniCalendar() {
            const year = miniCalendarDate.getFullYear();
            const month = miniCalendarDate.getMonth();

            // Update mini calendar header
            miniMonthElement.textContent = `${getMonthName(month).substring(0, 3)} ${year}`;

            // Clear mini calendar
            miniCalendar.innerHTML = '';

            // Add weekday headers
            const weekdays = ['S', 'M', 'T', 'W', 'T', 'F', 'S'];
            weekdays.forEach(day => {
                const dayElement = document.createElement('div');
                dayElement.textContent = day;
                dayElement.style.fontWeight = '600';
                dayElement.style.color = '#667eea';
                miniCalendar.appendChild(dayElement);
            });

            // Get first day of month and total days
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const totalDays = lastDay.getDate();
            const startingDay = firstDay.getDay();

            // Add empty cells for days from previous month
            for (let i = 0; i < startingDay; i++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'mini-day other-month';
                dayElement.textContent = '';
                miniCalendar.appendChild(dayElement);
            }

            // Add days from current month
            const today = new Date();
            const selected = selectedDate;

            for (let day = 1; day <= totalDays; day++) {
                const date = new Date(year, month, day);
                const dayElement = document.createElement('div');
                dayElement.className = 'mini-day';
                dayElement.textContent = day;

                // Check if this is today
                if (date.toDateString() === today.toDateString()) {
                    dayElement.classList.add('today');
                }

                // Check if this is selected date
                if (date.getDate() === selected.getDate() &&
                    date.getMonth() === selected.getMonth() &&
                    date.getFullYear() === selected.getFullYear()) {
                    dayElement.classList.add('selected');
                }

                // Check if this day is from other month
                if (date.getMonth() !== month) {
                    dayElement.classList.add('other-month');
                }

                dayElement.onclick = () => {
                    selectDate(date);
                    // If the date is in a different month, update the main calendar
                    if (date.getMonth() !== currentDate.getMonth() ||
                        date.getFullYear() !== currentDate.getFullYear()) {
                        currentDate = new Date(date);
                        renderCalendar();
                        updateStatistics();
                    }
                };

                miniCalendar.appendChild(dayElement);
            }
        }

        // Mini calendar navigation
        function previousMiniMonth() {
            miniCalendarDate.setMonth(miniCalendarDate.getMonth() - 1);
            renderMiniCalendar();
        }

        function nextMiniMonth() {
            miniCalendarDate.setMonth(miniCalendarDate.getMonth() + 1);
            renderMiniCalendar();
        }

        // Helper functions
        function getMonthName(monthIndex) {
            const months = [
                'January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'
            ];
            return months[monthIndex];
        }

        function formatTime(timeString) {
            const [hours, minutes] = timeString.split(':');
            const hour = parseInt(hours);
            const period = hour >= 12 ? 'PM' : 'AM';
            const formattedHour = hour % 12 || 12;
            return `${formattedHour}:${minutes} ${period}`;
        }

        // Show notification
        function showNotification(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 30px;
                left: 50%;
                transform: translateX(-50%) translateY(100px);
                background: rgba(255, 255, 255, 0.95);
                color: #333;
                padding: 15px 25px;
                border-radius: 25px;
                backdrop-filter: blur(10px);
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
                z-index: 1000;
                transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                font-weight: 500;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(-50%) translateY(0)';
            }, 10);

            // Remove after delay
            setTimeout(() => {
                notification.style.transform = 'translateX(-50%) translateY(100px)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 500);
            }, 3000);
        }

        // Toggle theme
        function toggleTheme() {
            document.body.classList.toggle('dark-mode');
            const themeToggle = document.querySelector('.theme-toggle');
            themeToggle.textContent = document.body.classList.contains('dark-mode') ? '‚òÄÔ∏è' : 'üåô';
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>